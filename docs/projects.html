<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projects - QMES</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <!-- Navbar will be injected here by navbar.js -->
    </header>

    <div class="projects-hero">
        <img src="assets/bg-projects.jpg" alt="Projects Background">
    </div>

    <main class="projects-page">
        <section class="projects-section">
            <div class="project-title-section">
                <!-- This will be populated dynamically based on whether we're viewing a specific project or the list -->
            </div>
            
            <div class="projects-search">
                <div class="search-bar">
                    <div class="search-input-group">
                        <input type="text" id="projectSearch" placeholder="Type / to Search">
                        <button class="search-btn">Search</button>
                    </div>
                    <div class="date-filter">
                        <label>From</label>
                        <input type="date" id="dateFrom">
                        <label>till</label>
                        <input type="date" id="dateTo">
                    </div>
                    <div class="archive-toggle">
                        <input type="checkbox" id="showArchived">
                        <label for="showArchived">Show archived projects</label>
                    </div>
                </div>
            </div>

            <div class="projects-list">
                <!-- Projects will be loaded dynamically here -->
            </div>
        </section>

        <div class="project-container">
            <!-- Individual project content will be loaded here when viewing a specific project -->
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h4>Social Media:</h4>
                <ul>
                    <li><a href="#" id="linkedin-link">LinkedIn</a></li>
                    <li><a href="#" id="github-link">Github</a></li>
                    <li><a href="#" id="instagram-link">Instagram</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Address:</h4>
                <p>QMUL</p>
            </div>
            <div class="footer-section">
                <h4>Contact Details:</h4>
                <p><a href="#" id="email-link">Email</a></p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>Powered by <a href="#">Jekyll</a> and my sleepless nights &nbsp;&nbsp; Hosted by <a href="#">Github</a></p>
        </div>
    </footer>

    <script type="module">
        import { initializeProjectsPage, initializeProjectPage } from './js/projects.js';
        import { initializeNavbar } from './js/navbar.js';
        
        // Check if we're on a specific project page
        const urlParams = new URLSearchParams(window.location.search);
        const projectId = urlParams.get('project');
        
        if (projectId) {
            // Load specific project
            initializeProjectPage(projectId);
            document.querySelector('.projects-search').style.display = 'none';
            document.querySelector('.projects-list').style.display = 'none';
        } else {
            // Load projects list
            initializeProjectsPage();
            document.querySelector('.project-title-section').innerHTML = '<h1>Our Projects</h1>';
            
            // Initialize search functionality
            const searchInput = document.getElementById('projectSearch');
            const searchBtn = document.querySelector('.search-btn');
            const dateFrom = document.getElementById('dateFrom');
            const dateTo = document.getElementById('dateTo');
            const showArchived = document.getElementById('showArchived');

            // Set default dates
            const today = new Date();
            dateTo.valueAsDate = today;
            const defaultFromDate = new Date('2004-12-23');
            dateFrom.valueAsDate = defaultFromDate;

            // Search functionality
            function filterProjects() {
                const searchTerm = searchInput.value.toLowerCase();
                const fromDate = dateFrom.valueAsDate;
                const toDate = dateTo.valueAsDate;
                const archived = showArchived.checked;

                document.querySelectorAll('.project-card').forEach(project => {
                    const title = project.querySelector('h3').textContent.toLowerCase();
                    const summary = project.querySelector('.project-info p:nth-child(3)').textContent.toLowerCase();
                    const dateStr = project.querySelector('.project-date').textContent;
                    const projectDate = new Date(dateStr);
                    
                    const matchesSearch = title.includes(searchTerm) || summary.includes(searchTerm);
                    const matchesDate = (!fromDate || projectDate >= fromDate) && 
                                      (!toDate || projectDate <= toDate);

                    project.style.display = matchesSearch && matchesDate ? 'flex' : 'none';
                });
            }

            // Event listeners
            searchBtn.addEventListener('click', filterProjects);
            searchInput.addEventListener('input', filterProjects);
            dateFrom.addEventListener('change', filterProjects);
            dateTo.addEventListener('change', filterProjects);
            showArchived.addEventListener('change', filterProjects);

            // Keyboard shortcut for search
            document.addEventListener('keydown', function(e) {
                if (e.key === '/' && document.activeElement !== searchInput) {
                    e.preventDefault();
                    searchInput.focus();
                }
            });
        }

        // Initialize navbar
        document.addEventListener('DOMContentLoaded', initializeNavbar);
    </script>
</body>
</html> 